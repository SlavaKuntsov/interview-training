## OLTP (Online Transaction Processing)

### Концепция и задачи  
OLTP‑системы предназначены для обработки большого количества коротких, простых транзакций в реальном времени — чаще всего CRUD‑операций (Create, Read, Update, Delete). Основная цель — обеспечить быструю, надёжную и согласованную работу прикладных систем (банкинг, интернет‑магазины, CRM, ERP).

### Характеристики  
- **Транзакции короткие и частые**: обычно несколько строк за одну операцию.  
- **Высокая конкурентность**: сотни и тысячи пользователей одновременно создают, изменяют, читают данные.  
- **Строгие гарантии ACID**: атомарность, согласованность, изолированность, надёжность данных.  
- **Нормализованные схемы**: данные организованы по 3NF и выше, чтобы минимизировать избыточность и обеспечить целостность ссылок.  
- **Индексы на ключах**: ускоряют поиск по первичным ключам и внешним ключам.  
- **Небольшой объём данных на одну транзакцию**: каждая операция затрагивает небольшой набор строк.

### Примеры  
- Банковские переводы: списать со счёта A, зачислить на счёт B.  
- Интернет‑магазин: оформить заказ, уменьшить остатки товаров, записать платёж.  
- Системы бронирования: проверить наличие билета, зарезервировать место, подтвердить оплату.

### Архитектура и оптимизация  
- Использование репликации master‑slave для распределения чтения и отказоустойчивости.  
- Горизонтальная шардировка (partitioning) для распределения нагрузки по ключам.  
- Кэширование горячих данных (Redis, Memcached) для уменьшения нагрузки на базу.  
- Пул соединений и оптимизация параметров блокировок (lock escalation, row‑level locking).

---

## OLAP (Online Analytical Processing)

### Концепция и задачи  
OLAP‑системы фокусируются на аналитических запросах к большим объёмам исторических данных — агрегации, сводных отчётов, многомерного анализа (по измерениям‑dimensions и метрикам‑measures). Цель — дать бизнес‑пользователям гибкий инструмент для принятия решений и построения отчётов.

### Характеристики  
- **Запросы ресурсоёмкие и редкие**: сложные `GROUP BY`, `ROLLUP`, `CUBE`, `JOIN` по большим таблицам.  
- **Большой объём данных**: сотни гигабайт или терабайты исторических записей.  
- **Слабая транзакционность**: обычно read‑only, новые данные загружаются пакетно (ETL) вне оперативного времени.  
- **Денормализованные схемы**: звёздчатые (star) и снежинки (snowflake) схемы для ускорения агрегаций.  
- **Индексы и агрегаты**: bitmap‑индексы, материализованные представления, OLAP‑кубы.

### Примеры  
- Анализ продаж по регионам и категориям товаров за квартал.  
- Построение финансовых отчётов (P&L, балансы) с распределением по центрам затрат.  
- Когортный анализ поведения пользователей, расчёт LTV, retention rate.

### Архитектура и оптимизация  
- **Data Warehouse** (хранилище данных): централизованный репозиторий агрегированных и очищенных данных, загружаемый через ETL/ELT‑процессы из OLTP и внешних источников.  
- **Схемы**:
  - **Star Schema**: факт-таблица (transactions, sales) в центре, окружают таблицы измерений (time, product, customer).  
  - **Snowflake Schema**: измерения разбиваются на иерархические под‑измерения (например, city → region → country).  
- **Кубы OLAP**: многомерные структуры данных (например, Microsoft Analysis Services), позволяющие быстро получать предвычисленные агрегации.  
- **Колонно‑ориентированные СУБД**: Vertica, ClickHouse, Amazon Redshift, Azure Synapse, оптимизированы для сканирования столбцов и компрессии.  
- **Материализованные представления**: предварительно агрегированные таблицы, автоматически обновляемые по расписанию.

---

## Ключевые отличия OLTP и OLAP

| Аспект                         | OLTP                                            | OLAP                                               |
|--------------------------------|-------------------------------------------------|----------------------------------------------------|
| Цель                           | Обработка транзакций в реальном времени         | Аналитика и отчётность на исторических данных      |
| Тип нагрузки                   | Множество коротких операций чтения/записи       | Небольшое число тяжёлых запросов на чтение         |
| Схема данных                   | Нормализованная (3NF+)                          | Денормализованная (звезда, снежинка)               |
| Гарантии                       | ACID                                            | В основном консистентность eventual (ETL‑загрузка) |
| Объём данных                   | GB–TB                                           | TB–PB                                             |
| Индексы и структуры            | B‑Tree, хэш‑индексы на ключах                   | Bitmap, материализованные представления, кубы      |
| Обновления                     | Постоянные, мелкие, в реальном времени          | Редкие, пакетные (ETL)                             |
| Пользователи                   | Операционные системы, сервисы, приложения       | Аналитики, бизнес‑пользователи, BI‑инструменты     |
| Время отклика                  | Миллисекунды                                    | Секунды–минуты (зависит от сложности запроса)      |

---

**Правильное проектирование инфраструктуры** учитывает оба подхода:
- OLTP для повседневных операций и обеспечения быстрого отклика клиентам.
- OLAP для глубокого анализа, стратегического планирования и построения отчётов.
- Между ними обычно выстраивается ETL‑конвейер, регулярно переносящий данные из OLTP в OLAP с необходимой трансформацией и очисткой.```
